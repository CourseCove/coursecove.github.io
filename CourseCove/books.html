<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Course & Book Aggregator | CourseCove</title>
<style>
body { font-family: Arial, sans-serif; background: #f9f9f9; margin: 20px; }
.search-bar, .category-filter { width: 100%; padding: 12px 16px; border-radius: 12px; border: 1px solid #ccc; margin-bottom: 16px; font-size: 16px; }
#course-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 24px; }
.book-card { background: white; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); padding: 16px; transition: transform 0.2s ease, box-shadow 0.2s ease; }
.book-card:hover { transform: translateY(-4px); box-shadow: 0 8px 20px rgba(0,0,0,0.12); }
.book-card img { width: 100%; height: 180px; object-fit: cover; border-radius: 12px; margin-bottom: 12px; }
.book-card h3 { font-size: 18px; font-weight: 600; margin: 0 0 6px; color: #111; }
.book-card p { font-size: 14px; margin: 2px 0; color: #555; }
.book-card a { display: inline-block; margin-top: 8px; color: #1a73e8; font-weight: 500; text-decoration: none; }
.book-card a:hover { text-decoration: underline; }
.pagination { display: flex; justify-content: center; align-items: center; gap: 12px; margin-top: 32px; }
.pagination button { background: #1a73e8; color: white; border: none; padding: 8px 16px; border-radius: 8px; cursor: pointer; font-weight: 500; }
.pagination button:hover { background: #1664c1; }
#pageInfo { font-weight: 500; color: #333; }
#loading { text-align:center; margin-top:20px; font-weight:bold; color:#555; }
#progress { text-align:center; margin-top:8px; font-size:0.9em; color:#666; }
</style>
</head>
<body>

<header>
  <h1>Course & Book Aggregator</h1>
  <p>Browse curated courses and free books in one place</p>
</header>

<input type="text" id="searchBar" placeholder="Search courses or books..." class="search-bar" />
<select id="categoryFilter" class="category-filter">
  <option value="">All Categories</option>
  <option value="politics">Politics</option>
  <option value="economics">Economics</option>
  <option value="philosophy">Philosophy</option>
  <option value="science">Science</option>
  <option value="history">History</option>
</select>

<div id="course-container"></div>
<div id="loading">Loading more books...</div>
<div id="progress"></div>

<div class="pagination">
  <button id="prevPage">Previous</button>
  <span id="pageInfo">Page 1</span>
  <button id="nextPage">Next</button>
</div>

<script>
const courseContainer = document.getElementById('course-container');
const searchBar = document.getElementById('searchBar');
const categoryFilter = document.getElementById('categoryFilter');
const prevPageBtn = document.getElementById('prevPage');
const nextPageBtn = document.getElementById('nextPage');
const pageInfo = document.getElementById('pageInfo');
const loadingEl = document.getElementById('loading');
const progressEl = document.getElementById('progress');

let allItems = [];
let filteredItems = [];
let currentPage = 1;
const itemsPerPage = 6;

// --- Starter books
const starterBooks = [
  { title:"Pride and Prejudice", authors:"Jane Austen", link:"https://www.gutenberg.org/ebooks/1342", cover:"https://www.gutenberg.org/cache/epub/1342/pg1342.cover.medium.jpg", type:"book", category:"literature" },
  { title:"The Republic", authors:"Plato", link:"https://www.gutenberg.org/ebooks/1497", cover:"https://www.gutenberg.org/cache/epub/1497/pg1497.cover.medium.jpg", type:"book", category:"philosophy" },
  { title:"Meditations", authors:"Marcus Aurelius", link:"https://www.gutenberg.org/ebooks/2680", cover:"https://www.gutenberg.org/cache/epub/2680/pg2680.cover.medium.jpg", type:"book", category:"philosophy" }
];

// --- Render items
function renderItems() {
  const start = (currentPage-1)*itemsPerPage;
  const end = start + itemsPerPage;
  const paginated = filteredItems.slice(start, end);

  courseContainer.innerHTML = "";
  if (paginated.length === 0) {
    courseContainer.innerHTML = `<p style="grid-column:1/-1;text-align:center;color:#777;">No results found.</p>`;
  }
  paginated.forEach(item=>{
    const card = document.createElement("div");
    card.className="book-card";
    card.innerHTML = `
      ${item.cover?`<img src="${item.cover}" alt="${item.title}">`:""}
      <h3>${item.title}</h3>
      <p>${item.type==="book"?"Author: "+item.authors:"Instructor: "+item.instructors}</p>
      <p style="font-size:12px;color:#888;">${item.category?("Category: "+item.category):("Source: "+item.source)}</p>
      <a href="${item.link}" target="_blank">${item.type==="book"?"Read / Borrow":"View Course"}</a>
    `;
    courseContainer.appendChild(card);
  });
  pageInfo.textContent = `Page ${currentPage} of ${Math.max(1, Math.ceil(filteredItems.length/itemsPerPage))}`;
}

// --- Apply filters instantly
function applyFilters() {
  const query = searchBar.value.toLowerCase();
  const category = categoryFilter.value.toLowerCase();

  filteredItems = allItems.filter(item=>{
    const matchesQuery = item.title.toLowerCase().includes(query);
    const matchesCategory = !category || (item.category && item.category.toLowerCase()===category);
    return matchesQuery && matchesCategory;
  });
  currentPage = 1;
  renderItems();
}

// --- Pagination
prevPageBtn.addEventListener("click", ()=>{ if(currentPage>1){ currentPage--; renderItems(); }});
nextPageBtn.addEventListener("click", ()=>{ if(currentPage<Math.ceil(filteredItems.length/itemsPerPage)){ currentPage++; renderItems(); }});

// --- Fake fetchers (replace with real API calls)
async function fetchCourses() {
  return [
    { title:"Introduction to Political Science", instructors:"Alexandra Paskhaver", link:"#", type:"course", category:"politics" },
    { title:"Economics 101", instructors:"John Doe", link:"#", type:"course", category:"economics" }
  ];
}
async function fetchGutenbergBooks() {
  return [
    { title:"Democracy in America", authors:"Alexis de Tocqueville", link:"https://www.gutenberg.org/ebooks/815", cover:"https://www.gutenberg.org/cache/epub/815/pg815.cover.medium.jpg", type:"book", category:"politics" }
  ];
}
async function fetchOpenLibraryBooks() { return []; }
async function fetchGoogleBooks() { return []; }
async function fetchInternetArchive() { return []; }

// --- Progressive loading with live progress ---
async function loadAllItems() {
  allItems = [...starterBooks];
  filteredItems = allItems;
  renderItems();
  loadingEl.style.display = "block";
  progressEl.textContent = "0/4 sources loaded...";

  const sources = [
    { name:"Courses", fn: fetchCourses },
    { name:"Gutenberg", fn: fetchGutenbergBooks },
    { name:"Open Library", fn: fetchOpenLibraryBooks },
    { name:"Google Books", fn: fetchGoogleBooks }
  ];

  let completed = 0;
  sources.forEach(async source=>{
    try {
      const items = await source.fn();
      allItems.push(...items);
      completed++;
      progressEl.textContent = `${completed}/${sources.length} sources loaded...`;
      applyFilters();
    } catch(e) {
      console.error(`Error loading ${source.name}`, e);
      completed++;
      progressEl.textContent = `${completed}/${sources.length} sources loaded...`;
    }
  });

  // hide spinner after first source finishes
  Promise.race(sources.map(s=>s.fn())).then(()=>loadingEl.style.display="none");
}

// --- Bind events ---
searchBar.addEventListener("input", applyFilters);
categoryFilter.addEventListener("change", applyFilters);

// --- Initial load ---
loadAllItems();
</script>

</body>
</html>
