<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Course & Book Aggregator</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; background: #f9f9f9; }
  .search-input { width: 100%; padding: 10px; margin-bottom: 20px; font-size: 16px; border-radius: 8px; border: 1px solid #ccc; }
  .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px; }
  .book-card { background: white; border-radius: 12px; padding: 16px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
  .book-card img { max-width: 100%; height: 180px; object-fit: cover; border-radius: 8px; margin-bottom: 10px; }
  .book-card h3 { font-size: 18px; margin: 0 0 5px; }
  .book-card p { font-size: 14px; margin: 2px 0; color: #555; }
  .book-card a { color: #1e90ff; text-decoration: none; font-weight: bold; display: inline-block; margin-top: 5px; }
  .book-card a:hover { text-decoration: underline; }
  .pagination { margin-top: 20px; display: flex; justify-content: center; align-items: center; gap: 10px; }
  .pagination button { padding: 6px 12px; border-radius: 6px; border: 1px solid #ccc; background: white; cursor: pointer; }
  .pagination button:hover { background: #eee; }
</style>
</head>
<body>

<h1>Course & Book Aggregator</h1>
<input type="text" id="searchBar" placeholder="Search courses or books..." class="search-input" />

<div id="course-container" class="grid"></div>

<div class="pagination">
  <button id="prevPage">Previous</button>
  <span id="pageInfo">Page 1</span>
  <button id="nextPage">Next</button>
</div>

<p style="margin-top: 20px; font-size: 0.85em; color: #666;">
Book data sourced from <a href="https://www.gutenberg.org/" target="_blank">Project Gutenberg</a> and <a href="https://openlibrary.org/" target="_blank">Open Library / Internet Archive</a>.
</p>

<script>
const courseContainer = document.getElementById('course-container');
const searchBar = document.getElementById('searchBar');
const prevPageBtn = document.getElementById('prevPage');
const nextPageBtn = document.getElementById('nextPage');
const pageInfo = document.getElementById('pageInfo');

let allItems = [];
let filteredItems = [];
let currentPage = 1;
const itemsPerPage = 6;

// Fetch Project Gutenberg books
async function fetchGutenbergBooks(query) {
  const res = await fetch(`https://gutendex.com/books?search=${encodeURIComponent(query)}&page=1`);
  const data = await res.json();
  return data.results.map(book => ({
    title: book.title,
    authors: book.authors.map(a => a.name).join(", ") || "Unknown",
    link: book.formats["text/html"] || book.formats["application/epub+zip"],
    source: "Project Gutenberg",
    cover: "",
    type: "book"
  }));
}

// Fetch Open Library / Internet Archive books
async function fetchOpenLibraryBooks(query) {
  const res = await fetch(`https://openlibrary.org/search.json?q=${encodeURIComponent(query)}&limit=10`);
  const data = await res.json();
  return data.docs.map(book => ({
    title: book.title,
    authors: (book.author_name || ["Unknown"]).join(", "),
    link: book.key ? `https://openlibrary.org${book.key}` : "#",
    cover: book.cover_i ? `https://covers.openlibrary.org/b/id/${book.cover_i}-M.jpg` : "",
    source: "Open Library / Internet Archive",
    type: "book"
  }));
}

// Fetch your existing courses (replace with your actual JSON fetch if needed)
async function fetchCourses() {
  return [
    { title: "Introduction to Political Science", instructors: "Alexandra Paskhaver", link: "#", source: "Udemy", type: "course", cover: "" },
    { title: "Economics 101", instructors: "John Doe", link: "#", source: "Coursera", type: "course", cover: "" }
  ];
}

// Load all items
async function loadAllItems(query = "politics") {
  const [gutenberg, openLibrary, courses] = await Promise.all([
    fetchGutenbergBooks(query),
    fetchOpenLibraryBooks(query),
    fetchCourses()
  ]);
  allItems = [...courses, ...gutenberg, ...openLibrary];
  filteredItems = allItems;
  currentPage = 1;
  renderItems();
}

// Render items for current page
function renderItems() {
  const start = (currentPage - 1) * itemsPerPage;
  const end = start + itemsPerPage;
  const paginatedItems = filteredItems.slice(start, end);

  courseContainer.innerHTML = "";
  paginatedItems.forEach(item => {
    const card = document.createElement("div");
    card.className = "book-card";
    card.innerHTML = `
      ${item.cover ? `<img src="${item.cover}" alt="${item.title}">` : ""}
      <h3>${item.title}</h3>
      <p>${item.type === "book" ? "Author: " + item.authors : "Instructor: " + item.instructors}</p>
      <p style="font-size:12px;color:#888;">Source: ${item.source}</p>
      <a href="${item.link}" target="_blank">${item.type === "book" ? "Read / Borrow" : "View Course"}</a>
    `;
    courseContainer.appendChild(card);
  });

  pageInfo.textContent = `Page ${currentPage} of ${Math.ceil(filteredItems.length / itemsPerPage)}`;
}

// Pagination
prevPageBtn.addEventListener("click", () => {
  if (currentPage > 1) { currentPage--; renderItems(); }
});
nextPageBtn.addEventListener("click", () => {
  if (currentPage < Math.ceil(filteredItems.length / itemsPerPage)) { currentPage++; renderItems(); }
});

// Search filter
searchBar.addEventListener("input", () => {
  const query = searchBar.value.toLowerCase();
  filteredItems = allItems.filter(item =>
    item.title.toLowerCase().includes(query) ||
    (item.type === "book" ? item.authors.toLowerCase() : item.instructors.toLowerCase())
  );
  currentPage = 1;
  renderItems();
});

// Initial load
loadAllItems();
</script>

</body>
</html>
