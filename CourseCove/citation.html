<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Citation Generator | CourseCove</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="css/style.css" />
  <link rel="icon" type="image/png" href="images/favicon.png" />

  <style>
    body { background-color: #f8f9fa; }
    h1 { color: #2c3e50; }
    .card-img-top { height: 150px; object-fit: contain; background: #e9ecef; }
    .muted { color: #6b7280; }
    .hanging { display: block; text-indent: -1.5em; padding-left: 1.5em; margin-bottom: 0.5em; }
    button:hover { opacity: 0.9; transition: 0.2s; }
  </style>
</head>
<body class="bg-gray-50 text-gray-900">

<!-- Navbar -->
<nav class="navbar navbar-expand-lg" style="background-color: #e3e5e9;">
  <div class="container">
    <a class="navbar-brand" href="../index.html">
      <img src="images/logo1.png" alt="Course Aggregator Logo" style="height:70px;width:auto;" />
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon" style="filter: invert(1);"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
        <li class="nav-item"><a class="nav-link" href="math.html">Math</a></li>
        <li class="nav-item"><a class="nav-link" href="ai-ml.html">AI / ML</a></li>
        <li class="nav-item"><a class="nav-link" href="arts-humanities.html">Arts & Humanities</a></li>
        <li class="nav-item"><a class="nav-link" href="languages.html">Languages</a></li>
        <li class="nav-item"><a class="nav-link" href="politics-economics.html">Politics & Economics</a></li>
        <li class="nav-item"><a class="nav-link" href="environment.html">Environment</a></li>
        <li class="nav-item"><a class="nav-link" href="../blog.html">Blog</a></li>
        <li class="nav-item"><a class="nav-link" href="books.html">Books</a></li>
        <li class="nav-item"><a class="nav-link" href="articles.html">Articles</a></li>
        <li class="nav-item"><a class="nav-link active" href="citation.html">Citation generator</a></li>
        <li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
      </ul>
    </div>
  </div>
</nav>

<!-- Main Content -->
<main class="max-w-6xl mx-auto px-4 py-10 citation-form">
  <h1 class="text-3xl font-bold mb-2">Citation Generator</h1>
  <p class="muted mb-6">Create citations in APA, MLA, Chicago (Author-Date), Harvard, or Vancouver. Add multiple sources, then copy or download a fully formatted references list.</p>

  <section class="card p-6">
    <!-- Top controls -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
      <div>
        <label class="block text-sm font-medium">Style</label>
        <select id="style" class="mt-1 block w-full rounded border-gray-300 p-2">
          <option>APA 7</option>
          <option>MLA 9</option>
          <option>Chicago (Author-Date)</option>
          <option>Harvard</option>
          <option>Vancouver</option>
        </select>
      </div>
      <div>
        <label class="block text-sm font-medium">Source type</label>
        <select id="sourceType" class="mt-1 block w-full rounded border-gray-300 p-2">
          <option>Book</option>
          <option>Journal Article</option>
          <option>Website</option>
        </select>
      </div>
      <div class="flex items-end gap-2">
        <button id="fillExample" class="px-4 py-2 bg-gray-100 rounded hover:bg-gray-200">Fill example</button>
        <button id="generateAdd" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Generate & Add</button>
      </div>
    </div>

    <!-- Form -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <label class="block text-sm font-medium">Author(s)</label>
        <input id="author" placeholder="Last, First; Last2, First2" class="mt-1 p-2 w-full rounded border-gray-300" />
        <div class="author-input-note">Separate multiple authors with a semicolon: <span class="chip">Smith, John; Doe, Jane</span></div>
      </div>
      <div>
        <label class="block text-sm font-medium">Year</label>
        <input id="year" placeholder="2025 or leave blank for n.d." class="mt-1 p-2 w-full rounded border-gray-300" />
      </div>
      <div>
        <label class="block text-sm font-medium">Title</label>
        <input id="title" placeholder="Title of the work" class="mt-1 p-2 w-full rounded border-gray-300" />
      </div>
      <div id="extraFields"></div>
    </div>

    <!-- Preview -->
    <div class="mt-6">
      <label class="block text-sm font-medium">Preview (current style)</label>
      <div id="preview" class="mt-2 p-3 bg-gray-50 border border-gray-200 rounded min-h-[56px]"></div>
    </div>

    <!-- Actions for current item -->
    <div class="mt-4 flex gap-2">
      <button id="copyCurrent" class="px-3 py-1 bg-gray-100 rounded hover:bg-gray-200">Copy current</button>
      <button id="addToList" class="px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700">Add to list</button>
      <button id="resetForm" class="px-3 py-1 bg-gray-100 rounded hover:bg-gray-200">Reset form</button>
    </div>
  </section>

  <!-- References List -->
  <section class="mt-6">
    <div class="flex justify-between items-center mb-3">
      <h2 class="text-xl font-semibold">References</h2>
      <div class="flex gap-2 ref-controls">
        <button id="copyAll" class="px-3 py-1 bg-gray-100 rounded hover:bg-gray-200">Copy all</button>
        <button id="downloadAll" class="px-3 py-1 bg-gray-100 rounded hover:bg-gray-200">Download .txt</button>
        <button id="clearAll" class="px-3 py-1 bg-red-100 text-red-700 rounded hover:bg-red-200">Clear all</button>
      </div>
    </div>
    <div id="refsContainer" class="card p-4">
      <div id="emptyNote" class="muted">No citations yet — create a citation and click <strong>Add to list</strong>.</div>
      <ol id="refsList" class="references list-decimal pl-6"></ol>
    </div>
  </section>

  <p class="mt-6 small muted">Tip: this tool gives formatted citations for common cases. Always double-check against your institution’s style guide.</p>
</main>

<!-- Footer -->
<footer class="bg-dark text-white py-4 mt-5">
  <div class="container d-flex flex-column flex-md-row justify-content-between align-items-center">
    <div class="mb-2 mb-md-0">
      <strong>Course Aggregator</strong> &nbsp;|&nbsp;
      <strong>© 2025 All rights reserved.</strong>
    </div>
    <div>
      <a href="../index.html" class="text-light text-decoration-none me-3">Home</a>
      <a href="contact.html" class="text-light text-decoration-none me-3">Contact</a>
      <a href="privacy.html" class="text-light text-decoration-none">Privacy</a>
    </div>
  </div>
</footer>

<!-- Script -->
<script>
const styleEl = document.getElementById('style');
const typeEl = document.getElementById('sourceType');
const authorEl = document.getElementById('author');
const yearEl = document.getElementById('year');
const titleEl = document.getElementById('title');
const extraFields = document.getElementById('extraFields');
const preview = document.getElementById('preview');
const refsList = document.getElementById('refsList');
const emptyNote = document.getElementById('emptyNote');

let citations = [];

// Author parsing
function parseAuthors(raw){
  if(!raw) return [];
  return raw.split(';').map(s=>s.trim()).filter(Boolean).map(p=>{
    if(p.includes(',')){
      const parts = p.split(',');
      const last = parts[0]; const rest = parts.slice(1).join(',');
      return {last:last.trim(),first:rest.trim()};
    }
    const words = p.split(' ').filter(Boolean);
    return {first: words.slice(0,-1).join(' '), last: words.slice(-1)[0]};
  });
}

// Build formatted string
function buildFormatted(style,type,fields){
  const authors = parseAuthors(fields.author).map(a=>a.last + (a.first?`, ${a.first}`:'')).join('; ');
  if(!authors && !fields.title) return '';
  let text='';
  if(type==='Book'){
    if(style==='APA 7'){
      text = `${authors} (${fields.year||'n.d.'}). ${fields.title}. ${fields.place?fields.place+':':''} ${fields.publisher||''}. ${fields.doi||''}`;
    } else if(style==='MLA 9'){
      text = `${authors}. <em>${fields.title}</em>. ${fields.publisher}, ${fields.year||'n.d.'}.`;
    } else if(style==='Chicago (Author-Date)'){
      text = `${authors}. ${fields.year||'n.d.'}. <em>${fields.title}</em>. ${fields.place?fields.place+':':''} ${fields.publisher||''}.`;
    } else if(style==='Harvard'){
      text = `${authors}, ${fields.year||'n.d.'}, <em>${fields.title}</em>, ${fields.publisher}, ${fields.place||''}.`;
    } else if(style==='Vancouver'){
      text = `${authors}. ${fields.title}. ${fields.place?fields.place+':':''} ${fields.publisher}; ${fields.year||'n.d.'}.`;
    }
  } else if(type==='Journal Article'){
    text = `${authors} (${fields.year||'n.d.'}). ${fields.title}. ${fields.journal||''}, ${fields.volume||''}(${fields.issue||''}), ${fields.pages||''}. ${fields.doi||''}`;
  } else if(type==='Website'){
    text = `${authors} (${fields.year||'n.d.'}). ${fields.title}. ${fields.siteName||''}. Available at: ${fields.url||''} (Accessed: ${fields.accessDate||''})`;
  }
  return text.replace(/\s+/g,' ').trim();
}

// Render extra fields
function renderExtraFields(type){
  extraFields.innerHTML = '';
  if(type==='Book'){
    extraFields.innerHTML = `
      <div><label class="block text-sm font-medium">Publisher</label><input id="publisher" class="mt-1 p-2 w-full rounded border-gray-300" placeholder="Publisher name" /></div>
      <div><label class="block text-sm font-medium">Place (city)</label><input id="place" class="mt-1 p-2 w-full rounded border-gray-300" placeholder="City" /></div>
      <div><label class="block text-sm font-medium">DOI or URL</label><input id="doi" class="mt-1 p-2 w-full rounded border-gray-300" placeholder="10.xxxx/xxxxx or https://..." /></div>
    `;
  } else if(type==='Journal Article'){
    extraFields.innerHTML = `
      <div><label class="block text-sm font-medium">Journal</label><input id="journal" class="mt-1 p-2 w-full rounded border-gray-300" placeholder="Journal name" /></div>
      <div><label class="block text-sm font-medium">Volume</label><input id="volume" class="mt-1 p-2 w-full rounded border-gray-300" /></div>
      <div><label class="block text-sm font-medium">Issue</label><input id="issue" class="mt-1 p-2 w-full rounded border-gray-300" /></div>
      <div><label class="block text-sm font-medium">Pages</label><input id="pages" class="mt-1 p-2 w-full rounded border-gray-300" /></div>
      <div><label class="block text-sm font-medium">DOI or URL</label><input id="doi" class="mt-1 p-2 w-full rounded border-gray-300" placeholder="10.xxxx/xxxxx or https://..." /></div>
    `;
  } else if(type==='Website'){
    extraFields.innerHTML = `
      <div><label class="block text-sm font-medium">Site name</label><input id="siteName" class="mt-1 p-2 w-full rounded border-gray-300" /></div>
      <div><label class="block text-sm font-medium">URL</label><input id="url" class="mt-1 p-2 w-full rounded border-gray-300" /></div>
      <div><label class="block text-sm font-medium">Accessed</label><input id="accessDate" class="mt-1 p-2 w-full rounded border-gray-300" placeholder="August 5, 2025" /></div>
    `;
  }
}

// Collect all fields
function collectFields(){
  return {
    author: authorEl.value.trim(),
    year: yearEl.value.trim(),
    title: titleEl.value.trim(),
    publisher: document.getElementById('publisher')?.value.trim()||'',
    place: document.getElementById('place')?.value.trim()||'',
    doi: document.getElementById('doi')?.value.trim()||'',
    journal: document.getElementById('journal')?.value.trim()||'',
    volume: document.getElementById('volume')?.value.trim()||'',
    issue: document.getElementById('issue')?.value.trim()||'',
    pages: document.getElementById('pages')?.value.trim()||'',
    siteName: document.getElementById('siteName')?.value.trim()||'',
    url: document.getElementById('url')?.value.trim()||'',
    accessDate: document.getElementById('accessDate')?.value.trim()||''
  };
}

// Preview
function generatePreview(){
  preview.innerHTML = `<span class="hanging">${buildFormatted(styleEl.value,typeEl.value,collectFields())}</span>`;
}

// Add to list
function addToList(){
  const formatted = buildFormatted(styleEl.value,typeEl.value,collectFields());
  if(!formatted) return alert('Fill required fields');
  const entry = {id: Date.now(), formatted};
  citations.push(entry);
  renderList();
  preview.innerHTML='';
  resetForm();
}

// Render list
function renderList(){
  refsList.innerHTML='';
  if(!citations.length){ emptyNote.style.display='block'; return; }
  emptyNote.style.display='none';
  citations.forEach(c=>{
    const li = document.createElement('li');
    li.className='ref-item';
    li.innerHTML = `<span class="hanging">${c.formatted}</span> <button class="removeBtn px-2 py-1 text-sm bg-red-50 text-red-600 rounded" data-id="${c.id}">Remove</button>`;
    refsList.appendChild(li);
  });
  document.querySelectorAll('.removeBtn').forEach(btn=>{
    btn.onclick = e=>{
      const id=Number(e.currentTarget.dataset.id);
      citations = citations.filter(x=>x.id!==id);
      renderList();
    };
  });
}

// Reset form
function resetForm(){
  authorEl.value=''; yearEl.value=''; titleEl.value='';
  renderExtraFields(typeEl.value);
  preview.innerHTML='';
}

// Example filler
function fillExample(){
  authorEl.value='Smith, John; Doe, Jane';
  yearEl.value='2025';
  titleEl.value='Introduction to Citation Generators';
  if(typeEl.value==='Book'){
    document.getElementById('publisher').value='CourseCove Press';
    document.getElementById('place').value='New York';
    document.getElementById('doi').value='10.1234/example';
  }
  generatePreview();
}

// Event listeners
typeEl.addEventListener('change',()=>{ renderExtraFields(typeEl.value); preview.innerHTML=''; });
document.getElementById('generateAdd').addEventListener('click',()=>{ generatePreview(); addToList(); });
document.getElementById('addToList').addEventListener('click',addToList);
document.getElementById('resetForm').addEventListener('click',resetForm);
document.getElementById('fillExample').addEventListener('click',fillExample);
document.getElementById('copyCurrent').addEventListener('click',()=>{navigator.clipboard.writeText(preview.innerText);});
document.getElementById('copyAll').addEventListener('click',()=>{navigator.clipboard.writeText(citations.map(c=>c.formatted).join('\n'));});
document.getElementById('clearAll').addEventListener('click',()=>{citations=[];renderList();});
document.getElementById('downloadAll').addEventListener('click',()=>{
  const blob = new Blob([citations.map(c=>c.formatted).join('\n')], {type:'text/plain'});
  const a=document.createElement('a');
  a.href=URL.createObjectURL(blob);
  a.download='references.txt';
  a.click();
});
window.addEventListener('DOMContentLoaded',()=>renderExtraFields(typeEl.value));
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
